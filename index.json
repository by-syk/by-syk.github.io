[{"content":"\r\n\r\n![王昭君 - 精灵公主 海报](https://ws1.sinaimg.cn/large/a219f5d5gy1fqyjbtclqzj21hc0oi47w.jpg)\r\n\r\n海报来源：[王者荣耀官网](http://pvp.qq.com/web201605/herodetail/152.shtml)\r\n\r\n```python\r\n# 下载王者荣耀全部英雄海报\r\n# 海报尺寸为 1920x882，截至目前共计 237 张，大小约 60 MB\r\n# author: By_syk \u003cBy_syk@163.com\u003e\r\n# date: 2018-01-13\r\n\r\n\r\nfrom urllib import request\r\nimport json\r\nimport os\r\n\r\n\r\n# 英雄数据URL\r\nURL_HERO = r'https://pvp.qq.com/web201605/js/herolist.json'\r\n# 英雄海报图片URL\r\nURL_HERO_COVER_IMG = r'http://game.gtimg.cn/images/yxzj/img201606/skin/hero-info/%d/%d-bigskin-%d.jpg'\r\n# 图片存放路径\r\nFOLDER_SAVE = r'E:/Download/QQPVPHeroCover'\r\n\r\n\r\ndef download_cover(hero_id, hero_name, cover_names):\r\n    if not os.path.exists(FOLDER_SAVE):\r\n        os.makedirs(FOLDER_SAVE)\r\n\r\n    for i, cover_name in enumerate(cover_names):\r\n        print('downloading:', hero_name, '-', cover_name)\r\n        file_path = '%s/%s-%s.jpg' % (FOLDER_SAVE, hero_name, cover_name)  # 生成图片文件名\r\n        if os.path.exists(file_path):  # 避免重复下载\r\n            continue\r\n        # 样例：http://game.gtimg.cn/images/yxzj/img201606/skin/hero-info/152/152-bigskin-2.jpg\r\n        url_img = URL_HERO_COVER_IMG % (hero_id, hero_id, i + 1)  # 生成海报图片URL\r\n        res = request.urlopen(url_img)\r\n        data = res.read()\r\n        with open(file_path, 'wb') as file:\r\n            file.write(data)\r\n\r\n\r\ndef download_all():\r\n    print('start to download')\r\n    res = request.urlopen(URL_HERO)\r\n    data = res.read().decode('utf-8')\r\n    data_json = json.loads(data)\r\n    for hero_data in data_json:\r\n        # 样例：{'ename': 105, 'cname': '廉颇', 'title': '正义爆轰', 'new_type': 0, 'hero_type': 3, 'skin_name': '正义爆轰|地狱岩魂'}\r\n        download_cover(int(hero_data['ename']),\r\n                       hero_data['cname'],\r\n                       hero_data['skin_name'].split('|'))\r\n    print('all done')\r\n\r\n\r\nif __name__ == '__main__':\r\n    download_all()\r\n\r\n```\r\n\r\n完整代码：[Github / get_qq_moba_hero_cover](https://github.com/by-syk/get_qq_moba_hero_cover)\r\n\r\n#### 改进 #1\r\n\r\n```python\r\n# res = request.urlopen(url_img)\r\n#    data = res.read()\r\n#    with open(file_path, 'wb') as file:\r\n#        file.write(data)\r\nrequest.urlretrieve(url_img, file_path)\r\n```\r\n\r\n## 方案2\r\n\r\n![白起 - 最终兵器 海报](https://ws1.sinaimg.cn/large/a219f5d5gy1fqyjcry5zyj21hc0u0qi4.jpg)\r\n\r\n```python\r\n# 下载王者荣耀全部英雄海报\r\n# 海报尺寸可选，截至目前共计 242 张，1080P 大小约 160 MB\r\n# author: By_syk \u003cBy_syk@163.com\u003e\r\n# date: 2018-01-25\r\n\r\n\r\nfrom urllib import request\r\nimport json\r\nimport os\r\nimport urllib\r\n\r\n# 英雄数据URL\r\n# 核心参数：页次 page，每页数量 iListNum\r\nURL_HERO = r'http://apps.game.qq.com/cgi-bin/ams/module/ishow/V1.0/query/workList_inc.cgi?' \\\r\n           r'sDataType=JSON\u0026iActId=2735\u0026iListNum=64\u0026page=%d'\r\n# 图片存放路径\r\nFOLDER_SAVE = r'E:/Download/QQPVPHeroCover/1920x1080'\r\n\r\n\r\ndef download_cover(url_img, hero_and_skin_name):\r\n    if not os.path.exists(FOLDER_SAVE):\r\n        os.makedirs(FOLDER_SAVE)\r\n\r\n    name_arr = hero_and_skin_name.split('-')\r\n    hero_name = name_arr[0]\r\n    skin_name = name_arr[1]\r\n    print('downloading:', hero_name, '-', skin_name, end=' ')\r\n    file_path = '%s/%s-%s.jpg' % (FOLDER_SAVE, hero_name, skin_name)  # 生成图片文件名\r\n    if os.path.exists(file_path):  # 避免重复下载\r\n        print('[exists]')\r\n        return\r\n    # 样例：http://shp.qpic.cn/ishow/2735092819/1475060911_1644740874_2501_sProdImgNo_6.jpg/0\r\n    if url_img.endswith('/200'):  # 生成海报图片 URL\r\n        url_img = url_img[:-3] + '0'\r\n    request.urlretrieve(url_img, file_path)\r\n    print('[ok]')\r\n\r\n\r\ndef download_all():\r\n    print('start to download')\r\n    for i in range(0, 10):\r\n        res = request.urlopen(URL_HERO % i)\r\n        data = res.read().decode('utf-8')\r\n        data_json = json.loads(data)\r\n        # data['iTotalLines'] 总数\r\n        core_json = data_json['List']\r\n        if len(core_json) == 0:\r\n            break\r\n        for hero_data in core_json:\r\n            # 壁纸尺寸参数：\r\n            # sProdImgNo_2: 1024x768\r\n            # sProdImgNo_3: 1280x720\r\n            # sProdImgNo_4: 1280x1024\r\n            # sProdImgNo_5: 1440x900\r\n            # sProdImgNo_6: 1920x1080\r\n            # sProdImgNo_7: 1920x1200\r\n            # sProdImgNo_8: 1920x1440\r\n            download_cover(urllib.request.unquote(hero_data['sProdImgNo_6']),\r\n                           urllib.request.unquote(hero_data['sProdName']))\r\n    print('all done')\r\n\r\n\r\nif __name__ == '__main__':\r\n    download_all()\r\n\r\n```\r\n\r\n#### 改进 #1\r\n\r\n```python\r\n# file_path = '%s/%s-%s.jpg' % (FOLDER_SAVE, hero_name, skin_name)  # 生成图片文件名\r\n# if os.path.exists(file_path):  # 避免重复下载\r\n#     print('[exists]')\r\n#     return\r\nfile_path = '%s/%s-%s.jpg' % (FOLDER_SAVE, hero_name, skin_name)  # 生成图片文件名\r\nfile_path_alt = '%s/%s-%s.jpg' % (FOLDER_SAVE, skin_name, hero_name)  # 用于除重\r\nif os.path.exists(file_path) | os.path.exists(file_path_alt):  # 避免重复下载\r\n    print('[exists]')\r\n    return\r\n```","cover":"https://ws1.sinaimg.cn/mw690/a219f5d5gy1fqyjbtclqzj21hc0oi47w.jpg","link":"get-qq-pvp-hero-cover.html","preview":"","title":"Python 例子之下载王者荣耀全部英雄海报"},{"content":"\r\n\r\n\u003e Hello, world!\r\n\r\n我是 [**By_syk**](mailto:By_syk@163.com)， 一名开发者。这是我尝试基于[**纸小墨**](http://www.chole.io/)构建并发布到 [**GitHub Pages**](https://pages.github.com/)  的个人博客。后续或将发布到[**简书**](https://www.jianshu.com/)的博客全部迁移过来。\r\n\r\n最后推荐一下上文提到的支撑我博客的工具：\r\n\r\n\u003e **纸小墨** —— 构建只为纯粹书写的博客  \r\n\u003e [http://www.chole.io](http://www.chole.io/)\r\n\u003e ![纸小墨](https://ws1.sinaimg.cn/large/a219f5d5gy1fqyjbhr0sej21950kogod.jpg)\r\n","cover":"https://ws1.sinaimg.cn/large/a219f5d5gy1fqyj9c4gbtj20kn07fgmr.jpg","link":"hello-world.html","preview":"\u003cp\u003e我是 By_syk， 一名开发者。\u003c/p\u003e\n","title":"Hello World"}]